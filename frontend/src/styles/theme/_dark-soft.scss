// Dark soft UI overrides for neumorphic-tinted surfaces
:root[data-theme="dark"] {
    --soft-bg: #12141b;
    --soft-surface: #1e2130;
    --soft-surface-alt: #2a2d3f;
    --soft-surface-highlight: #2a2d3f;
    --soft-border: #383a4a;
    --soft-text: #e0e0e0;
    --soft-text-muted: #c7c9d7;
    --soft-shadow-out: -2px -2px 6px rgba(255, 255, 255, 0.05), 3px 3px 12px rgba(0, 0, 0, 0.45);
    --soft-shadow-in: inset -1px -1px 2px rgba(255, 255, 255, 0.06), inset 2px 2px 4px rgba(0, 0, 0, 0.45);
    --soft-shadow-focus: 0 0 0 3px rgba(var(--color-primary-rgb, 138, 180, 248), 0.45);
    --soft-divider: rgba(255, 255, 255, 0.06);
    --soft-glass: color-mix(in srgb, var(--soft-surface) 90%, rgba(255, 255, 255, 0.04) 10%);
    --soft-glass-strong: color-mix(in srgb, var(--soft-surface-alt) 85%, rgba(255, 255, 255, 0.08) 15%);
    --soft-blur: blur(10px);
    --soft-motion: cubic-bezier(0.4, 0.14, 0.3, 1);
    --soft-speed: 240ms;
}

[data-theme="dark"] {
    color: var(--soft-text);

    // Tinted canvas + scrollbars
    body,
    .app-layout,
    .content-wrapper,
    .main-content,
    .app-shell,
    .app-content {
        background: var(--content-background, var(--soft-bg));
        color: var(--soft-text);
    }

    ::-webkit-scrollbar-track {
        background: color-mix(in srgb, var(--soft-bg) 70%, var(--soft-surface) 30%);
    }

    ::-webkit-scrollbar-thumb {
        background: color-mix(in srgb, var(--soft-border) 70%, var(--color-primary, #8ab4f8) 30%);
        box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--soft-surface) 70%, transparent);
    }

    // Core surfaces
    .hero-card,
    .panel,
    .data-table,
    .table-wrapper,
    .table-footer,
    .table-toolbar,
    .wizard-form,
    .wizard-content,
    .main-form-area,
    .photo-upload-card,
    .photo-upload-section,
    .guardian-card,
    .review-section,
    .list-card,
    .tile-card,
    .setup-card,
    .summary-card,
    .table-card,
    .modal-dialog,
    .modal-content {
        background: var(--soft-glass);
        border: 1px solid var(--soft-border);
        color: var(--soft-text);
        box-shadow: var(--soft-shadow-out);
        backdrop-filter: var(--soft-blur);
        transition: transform var(--soft-speed) var(--soft-motion), box-shadow var(--soft-speed) var(--soft-motion), background var(--soft-speed) var(--soft-motion);

        &:hover {
            transform: translateY(-2px);
            box-shadow: -4px -4px 10px rgba(255, 255, 255, 0.05), 6px 6px 16px rgba(0, 0, 0, 0.5);
        }
    }

    /* Cards should use theme surfaces, not glass */
    .card {
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        color: var(--color-text-primary);
        box-shadow: var(--shadow-sm);
        backdrop-filter: none;

        .card-header {
            border-bottom: 1px solid var(--color-border);
        }
    }

    .hero-card {
        background: linear-gradient(135deg,
                color-mix(in srgb, var(--soft-surface) 70%, var(--color-primary, #8ab4f8) 30%),
                color-mix(in srgb, var(--soft-surface-alt) 70%, var(--color-primary-dark, #5c6bd6) 30%));
        border: 1px solid var(--soft-border);
        box-shadow: -4px -4px 10px rgba(255, 255, 255, 0.05), 6px 6px 16px rgba(0, 0, 0, 0.45);
        background-size: 180% 180%;
        animation: hero-glow 12s ease-in-out infinite alternate;
        backdrop-filter: blur(14px);

        .hero-title,
        .hero-subtitle {
            color: var(--soft-text);
        }
    }

    @keyframes hero-glow {
        0% { background-position: 15% 20%; }
        50% { background-position: 85% 30%; }
        100% { background-position: 30% 80%; }
    }

    // Form scaffolding
    .form-actions,
    .wizard-footer,
    .wizard-actions,
    .form-toolbar {
        background: var(--soft-surface);
        border-top: 1px solid var(--soft-border);
        box-shadow: -2px -2px 6px rgba(255, 255, 255, 0.04), 4px 4px 12px rgba(0, 0, 0, 0.35);
    }

    label {
        color: var(--soft-text);
    }

    .form-description,
    .wizard-subtitle,
    .step-status,
    .form-hint,
    .helper-text {
        color: var(--soft-text-muted);
    }

    /* Modals should respect standard surfaces, not glass */
    .modal,
    .modal-content,
    .modal-dialog {
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        color: var(--color-text-primary);
        box-shadow: var(--shadow-md, 0 20px 50px rgba(0,0,0,0.35));
        backdrop-filter: none;
    }

    .modal-header {
        border-bottom: 1px solid var(--color-border);
    }

    // Form controls
    input:not([type="checkbox"]):not([type="radio"]):not([type="submit"]):not([type="button"]),
    select,
    textarea,
    .form-control,
    .search-input .form-control {
        background: var(--soft-surface-alt);
        border: 1px solid var(--soft-border);
        color: var(--soft-text);
        box-shadow: var(--soft-shadow-in);
        transition: box-shadow var(--soft-speed) var(--soft-motion), background var(--soft-speed) var(--soft-motion), border-color var(--soft-speed) var(--soft-motion);

        &::placeholder {
            color: var(--soft-text-muted);
        }

        &:hover {
            box-shadow: var(--soft-shadow-in), 0 0 0 1px rgba(var(--color-primary-rgb, 138, 180, 248), 0.12);
        }

        &:focus {
            outline: none;
            border-color: var(--color-primary, #8ab4f8);
            box-shadow: var(--soft-shadow-in), var(--soft-shadow-focus);
            background: color-mix(in srgb, var(--soft-surface-alt) 95%, var(--color-primary, #8ab4f8) 5%);
        }

        &:disabled {
            background: color-mix(in srgb, var(--soft-surface-alt) 92%, #ffffff 8%);
            color: var(--soft-text-muted);
            border-color: var(--soft-border);
            box-shadow: inset 1px 1px 2px rgba(0, 0, 0, 0.4), inset -1px -1px 2px rgba(255, 255, 255, 0.05);
        }
    }

    .required {
        color: var(--color-error, #e58b8b);
    }

    // Buttons
    .btn,
    button {
        border-radius: 10px;
        border: 1px solid var(--soft-border);
        background: linear-gradient(145deg, var(--soft-surface-alt), var(--soft-surface));
        color: var(--soft-text);
        box-shadow: var(--soft-shadow-out);
        transition: transform var(--soft-speed) var(--soft-motion), box-shadow var(--soft-speed) var(--soft-motion), filter var(--soft-speed) var(--soft-motion), background var(--soft-speed) var(--soft-motion);

        &:hover:not(:disabled) {
            filter: brightness(1.05);
            box-shadow: -3px -3px 8px rgba(255, 255, 255, 0.06), 4px 4px 12px rgba(0, 0, 0, 0.5);
        }

        &:active:not(:disabled) {
            box-shadow: var(--soft-shadow-in);
            transform: translateY(0);
        }

        &:disabled {
            opacity: 0.6;
        }
    }

    .btn-primary,
    button.btn-primary {
        background: linear-gradient(145deg, var(--color-primary-light, #a5c7ff), var(--color-primary, #8ab4f8));
        color: #0f1320;
        border: none;
        box-shadow: 0 10px 24px rgba(var(--color-primary-rgb, 138, 180, 248), 0.35), var(--soft-shadow-out);

        &:hover:not(:disabled) {
            filter: brightness(1.08);
        }
    }

    .btn-outline {
        background: transparent;
        color: var(--soft-text);
        box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.1);

        &:hover:not(:disabled) {
            color: var(--color-primary);
            box-shadow: inset 0 0 0 2px var(--color-primary);
        }
    }

    // Tables
    table,
    .table {
        background: var(--soft-surface);
        color: var(--soft-text);
    }

    .data-table table thead,
    .table thead {
        background: color-mix(in srgb, var(--color-surface, var(--soft-surface)) 88%, #ffffff 12%);

        th {
            color: var(--soft-text);
            border-bottom: 1px solid var(--soft-border);
        }
    }

    .data-table table tbody tr,
    .table tbody tr {
        background: var(--soft-surface);
        border-bottom: 1px solid var(--soft-border);

        &:nth-child(even) {
            background: color-mix(in srgb, var(--soft-surface) 94%, #ffffff 6%);
        }

        &:hover {
            background: color-mix(in srgb, var(--soft-surface) 80%, var(--color-primary, #8ab4f8) 20%);
            box-shadow: inset 0 0 0 1px rgba(var(--color-primary-rgb, 138, 180, 248), 0.35);
        }
    }

    .table-footer {
        background: var(--soft-surface);
        border-top: 1px solid var(--soft-border);
    }

    // Dropdowns & menus
    .dropdown-menu,
    .select-menu,
    .cdk-overlay-pane .menu-panel,
    .cdk-overlay-pane .select-panel {
        background: var(--soft-surface);
        border: 1px solid var(--soft-border);
        box-shadow: -4px -4px 8px rgba(255, 255, 255, 0.05), 8px 8px 16px rgba(0, 0, 0, 0.45);
        color: var(--soft-text);

        li,
        .menu-item {
            color: var(--soft-text);

            &:hover {
                background: color-mix(in srgb, var(--soft-surface-alt) 85%, var(--color-primary) 15%);
            }

            &.selected {
                background: rgba(var(--color-primary-rgb, 138, 180, 248), 0.2);
                color: var(--color-primary);
            }
        }
    }

    // Checkboxes & radios
    input[type="checkbox"],
    input[type="radio"] {
        accent-color: var(--color-primary, #8ab4f8);
        background: var(--soft-surface-alt);
        border: 1px solid var(--soft-border);
        box-shadow: var(--soft-shadow-in);
    }

    // Media / upload boxes
    .photo-upload-card,
    .photo-upload-section,
    .avatar-upload,
    .dropzone {
        background: var(--soft-surface);
        border: 1px dashed var(--soft-border);
        color: var(--soft-text);
    }

    .photo-preview-box,
    .avatar-preview,
    .media-preview {
        background: var(--soft-surface-alt);
        border: 2px dashed var(--soft-border);
        color: var(--soft-text-muted);
    }

    // Text helpers and empty states
    .empty-state,
    .helper,
    .placeholder-text {
        color: var(--soft-text-muted);
    }

    // Tree navigation
    .tree-node,
    .permission-tree .node {
        background: transparent;
        color: var(--soft-text);
        border-radius: 6px;
        padding: 0.5rem 0.75rem;

        &:hover {
            background: rgba(var(--color-primary-rgb, 138, 180, 248), 0.12);
        }

        &.selected {
            background: rgba(var(--color-primary-rgb, 138, 180, 248), 0.2);
            color: var(--color-primary);
            border-left: 3px solid var(--color-primary);
        }
    }

    // Modals / overlays
    .modal-backdrop,
    .cdk-overlay-backdrop {
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(6px);
    }
}
